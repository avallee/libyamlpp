stream ::= stream_begin directives headless_document documents
           footless_document stream_end
         | stream_begin directives headless_document footless_document
           stream_end
         | stream_begin directives headless_document stream_end
         | stream_begin directives footless_document stream_end
         | stream_begin directives headfootless_document stream_end
         | stream_begin directives documents stream_end

# TODO:  how does a stream begin?  encoding information?
stream_begin ::= ""

# TODO:  how does a stream end?
stream_end ::= ""

directives ::= directive directives
             | ""

directive ::= version_directive
            | tag_directive

version_directive ::= "%YAML" digit "." digit

digit ::= "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"

tag_directive ::= "%TAG" handle uri

documents ::= document documents
            | ""

#TODO:  is the second alternative correct?  what i want to say is that a
#       document may start with document_begin, followed by a node and then
#       either a document_end or nothing at all.  i don't think i can say
#       it ends with document_end or stream_end, because a stream is defined
#       to always end with a stream_end, so document shouldn't consume the
#       final stream_end (and there should only be one stream end, right?).
document ::= document_begin nodes document_end

headless_document ::= nodes document_end

headfootless_document ::= nodes

footless_document ::= document_begin nodes

document_begin ::= "---"

document_end ::= "..."

nodes ::= node nodes
        | ""

node ::= alias
       | scalar
       | sequence
       | mapping

# TODO:  define grammar for an alias
alias ::= ""

scalar ::= string
        | null
        | tag string

string ::= [^!].*

null ::= "null"

tag ::= "!" local_tag
     | "!!" standard_tag
     | "!" handle "!" local_tag
     | "tag:" uri ":" local_tag

local_tag ::= [a-zA-Z_]+

standard_tag ::= "str"

handle ::= [a-zA-Z_]+

# TODO:  define grammar for standard URIs.  e.g., yaml.org,2002:
uri ::= ""

sequence ::= flow_sequence
           | block_sequence

flow_sequence ::= "[" node ( "," [ ]* node )* "]"
                | "[" [ ]* "]"

# TODO:  define grammar for block sequence
block_sequence ::= ""

mapping ::= flow_mapping
          | block_mapping

flow_mapping ::= "{" scalar [ ]* ":" [ ]* node ( "," [ ]* scalar [ ]* ":" [ ]* node )* "}"
               | "{" complex_mapping [ ]* ":" [ ]* node ( "," [ ]* complex_mapping [ ]* ":" [ ]* node )* "}"
               | "{" [ ]* "}"

# TODO:  define complex mapping
complex_mapping ::= ""

# TODO:  define grammar for a block mapping
block_mapping ::= ""
